Module TestLambda
    Sub Main()
        ' Simple single-line lambda
        Dim double As Func(Of Integer, Integer) = Function(x As Integer) x * 2
        Dim result = double(21)
        PrintLine(result)  ' Should output 42

        ' Lambda without explicit types
        Dim add As Func(Of Integer, Integer, Integer) = Function(a, b) a + b
        PrintLine(add(10, 20))  ' Should output 30

        ' Sub lambda (Action)
        Dim greet As Action(Of String) = Sub(name)
            PrintLine("Hello, " & name)
        End Sub
        greet("World")  ' Should output "Hello, World"

        ' Lambda used with arrays (LINQ-style)
        Dim numbers = {1, 2, 3, 4, 5}
        ' Note: Where would need LINQ support, simplified test here

        ' Multi-line function lambda
        Dim calculate As Func(Of Integer, Integer, Integer) = Function(x, y)
            Dim temp = x + y
            Return temp * 2
        End Function
        PrintLine(calculate(5, 10))  ' Should output 30
    End Sub
End Module
